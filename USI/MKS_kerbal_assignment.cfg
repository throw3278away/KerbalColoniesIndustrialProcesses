// First, we need to differentiate different KCResourceConverterFacility
// This is done in a hardcoded way for now by manually adding subtype
@KCFacilityConfig[KCMiningFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = drilling
}
@KCFacilityConfig[KCIPSifterFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = sifter
}
@KCFacilityConfig[KCISRUFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = nonlsconverter
}
@KCFacilityConfig[KCIPNuclearWorksFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = nonlsconverter
}
@KCFacilityConfig[KCIPGreenhouseFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = greenhouse
}
@KCFacilityConfig[KCIPAgricultureFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = agriculture
}
@KCFacilityConfig[KCProductionFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = construction
}
@KCFacilityConfig[KCVABFacility]:NEEDS[KerbalColonies,KolonyTools]:LAST[zKCIP]
{
	%subtype = construction
}

// Then changes all allowedTraits according to the subtype
// Adapted from Crew Skills to Function Table on MKS Wiki based on subtype
// Scout and Kononist are useless for now
// Medic and Quartermaster are also useless as no buildings with the specified subtypes exist
// For those without subtype assignment, no changes will be made
@KCFacilityConfig[*]:HAS[#subtype[drilling]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Engineer,Miner
		}
	}
}
@KCFacilityConfig[*]:HAS[#subtype[sifter]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Engineer,Geologist
		}
	}
}
@KCFacilityConfig[*]:HAS[#subtype[nonlsconverter]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Engineer,Technician
		}
	}
}

@KCFacilityConfig[*]:HAS[#subtype[greenhouse]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Scientist,Biologist
		}
	}
}
@KCFacilityConfig[*]:HAS[#subtype[agriculture]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Scientist,Farmer:
		}
	}
}
@KCFacilityConfig[*]:HAS[#subtype[construction]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Engineer,Mechanic
		}
	}
}
@KCFacilityConfig[*]:HAS[#subtype[medbay]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Scientist,Medic
		}
	}
}
@KCFacilityConfig[*]:HAS[#subtype[logistics]]:NEEDS[KerbalColonies,KolonyTools]:LAST[zzKCIP]
{
	@level
	{
		@*:HAS[#allowedTraits[*]]
		{
			@allowedTraits = Pilot,Quartermaster
		}
	}
}